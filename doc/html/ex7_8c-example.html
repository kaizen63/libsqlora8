<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libsqlora8: ex7.c</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>ex7.c</h1>Example for using sqlo_fetch, sqlo_values, sqlo_ocol_name_lens, sqlo_ocol_names, sqlo_value_lens.<p>
<div class="fragment"><pre class="fragment"><span class="comment">/* $Id: ex7.c 287 2004-07-30 16:28:21Z kpoitschke $ */</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include "examples.h"</span>

<span class="keywordtype">int</span> do_select(sqlo_db_handle_t dbh, <span class="keywordtype">double</span> min_income)
{
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth;       <span class="comment">/* statement handle */</span>
  <span class="keywordtype">int</span> status;                   <span class="comment">/* status of sqlo calls */</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;                      <span class="comment">/* loop counter */</span>
  <span class="keyword">const</span> <span class="keywordtype">char</span> ** v;              <span class="comment">/* values */</span>
  <span class="keyword">const</span> <span class="keywordtype">char</span> ** col_names;      <span class="comment">/* column names */</span>
  CONST <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *nl;       <span class="comment">/* column name lengths */</span>
  CONST <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *vl;     <span class="comment">/* value lengths */</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc;              <span class="comment">/* number of columns */</span>


  sth = reopen_cursor(dbh, min_income); <span class="comment">/* see example of sqlo_reopen (ex6.c) */</span>

  <span class="comment">/* get the output column names */</span>
  status = <a name="a58"></a><a class="code" href="group__easy.html#ga10">sqlo_ocol_names2</a>(sth, &amp;nc, &amp;col_names);

  <span class="keywordflow">if</span> (0 &gt; status) {
    error_exit(dbh, <span class="stringliteral">"sqlo_ocol_names2"</span>);
  }

  <span class="comment">/* get the output column name lengths */</span>
  nl = <a name="a59"></a><a class="code" href="group__easy.html#ga11">sqlo_ocol_name_lens</a>(sth, NULL);

  printf(<span class="stringliteral">"Employees with SAL &gt; %-8.2f:\n"</span>, min_income);

  <span class="comment">/* print the header */</span>
  <span class="keywordflow">for</span> (i = 0; i &lt; nc; ++i)
    printf("%-*s ", nl[i], col_names[i]);

  printf("\n");
  for (i = 0; i &lt; nc; ++i) {
    <span class="keywordflow">for</span> (j = 0; j &lt; nl[i]; ++j) {
      putchar(<span class="charliteral">'-'</span>);
    }
    putchar(<span class="charliteral">'+'</span>);
  }
  putchar(<span class="charliteral">'\n'</span>);

  <span class="comment">/* fetch the data */</span>
  <span class="keywordflow">while</span> ( SQLO_SUCCESS == (status = (<a name="a60"></a><a class="code" href="group__easy.html#ga6">sqlo_fetch</a>(sth, 1)))) {
    
    <span class="comment">/* get one record */</span>
    v = <a name="a61"></a><a class="code" href="group__easy.html#ga7">sqlo_values</a>(sth, NULL, 1);

    <span class="comment">/* get the length of the data items */</span>
    vl = <a name="a62"></a><a class="code" href="group__easy.html#ga8">sqlo_value_lens</a>(sth, NULL);

    <span class="comment">/* print the column values */</span>
    <span class="keywordflow">for</span> (i = 0; i &lt; nc; ++i)
      printf("%-*s ", (vl[i] &gt; nl[i] ? vl[i] : nl[i]), v[i]);

    printf("\n");

  }

  if (0 &gt; status) {
    error_exit(dbh, <span class="stringliteral">"sqlo_fetch"</span>);
  }

  <span class="comment">/*</span>
<span class="comment">  if ( SQLO_SUCCESS != sqlo_close(sth))</span>
<span class="comment">    error_exit(dbh, "sqlo_close");</span>
<span class="comment">  */</span>
  <span class="keywordflow">return</span> 1;

}

<span class="comment">/* $Id: ex7.c 287 2004-07-30 16:28:21Z kpoitschke $ */</span>
</pre></div> <hr size="1"><address style="align: right;"><small>Generated on Fri Nov 4 16:19:04 2005 for libsqlora8 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
