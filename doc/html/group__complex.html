<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libsqlora8: The advanced interface.</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">Globals</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a> | <a class="qindex" href="examples.html">Examples</a></div>
<h1>The advanced interface.</h1>This functions offer more flexibility in terms of datatypes, but they need (much) more parameters.  
<a href="#_details">More...</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__complex.html#ga0">sqlo_prepare</a> (<a class="el" href="group__typedefs.html#ga0">sqlo_db_handle_t</a> dbh, const char *stmt)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Parse a statement.  <a href="#ga0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__complex.html#ga1">sqlo_bind_by_name</a> (<a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth, const char *name, int param_type, const void *param_addr, unsigned int param_size, short *ind_addr, int is_array)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Bind a variable by name.  <a href="#ga1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__complex.html#ga2">sqlo_bind_ref_cursor</a> (<a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth, const char *cursor_name, int *sth2p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Bind a REF CURSOR.  <a href="#ga2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__complex.html#ga3">sqlo_bind_by_pos</a> (<a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth, int position, int param_type, const void *param_addr, unsigned int param_size, short *ind_addr, int is_array)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Bind a variable by position.  <a href="#ga3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__complex.html#ga4">sqlo_bind_by_pos2</a> (<a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth, int position, int param_type, const void *param_addr, unsigned int param_size, short *ind_addr, unsigned short *rcode_addr, unsigned int skip_size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Bind a variable by position.  <a href="#ga4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__complex.html#ga5">sqlo_define_by_pos</a> (<a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth, int value_pos, int value_type, const void *value_addr, unsigned int value_size, short *ind_addr, short *rlen_addr, int is_array)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define a output variable of the select list.  <a href="#ga5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__complex.html#ga6">sqlo_define_by_pos2</a> (<a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth, int value_pos, int value_type, const void *value_addr, unsigned int value_size, short *ind_addr, unsigned short *rlen_addr, unsigned short *rcode_addr, unsigned int skip_size)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define a output variable of the select list.  <a href="#ga6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__complex.html#ga7">sqlo_define_ntable</a> (<a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth, unsigned int pos, int *sth2p)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define a nested table Please visit the example for details.  <a href="#ga7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__complex.html#ga8">sqlo_execute</a> (<a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth, unsigned int iterations)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Execute a statement.  <a href="#ga8"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
This functions offer more flexibility in terms of datatypes, but they need (much) more parameters. 
<p>
Use these functions if you want to execute PL/SQL or stored procedures. <hr><h2>Function Documentation</h2>
<a class="anchor" name="ga1" doxytag="sqlora.h::sqlo_bind_by_name"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int sqlo_bind_by_name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>param_type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>param_size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>short *&nbsp;</td>
          <td class="mdname" nowrap> <em>ind_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>is_array</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bind a variable by name. 
<p>
Use this to bind a variable in a query or a stored procedure call.<p>
If is_array is 1, the parameters param_addr and ind_addr must point to arrays. ind_addr is optional and can be passed a NULL. The param_size is still the size of one array element, not the whole array size!<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sth</em>&nbsp;</td><td>I - The statement handle. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>I - The bind parameter name. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_type</em>&nbsp;</td><td>I - The datatype of the bind parameter (see <a class="el" href="group__constants.html#ga6">sqlo_data_types</a>). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_addr</em>&nbsp;</td><td>I - The address of a variable or array. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_size</em>&nbsp;</td><td>I - The size of the object at param_addr in bytes. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ind_addr</em>&nbsp;</td><td>I - The pointer to the NULL indicator variable (optional). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>is_array</em>&nbsp;</td><td>I - 1 means param_addr points to an array, 0 means a single variable.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>
SQLO_SUCCESS </li>
<li>
&lt; 0 on error </li>
</ul>
</dd></dl>
<dl compact><dt><b>Example:</b></dt><dd><div class="fragment"><pre class="fragment"><span class="comment">/* $Id: ex9.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include "examples.h"</span>

<span class="keyword">static</span> <span class="keywordtype">void</span> create_sp __P((sqlo_db_handle_t dbh));

<span class="keywordtype">int</span> call_plsql(sqlo_db_handle_t dbh)
{
  <span class="keywordtype">double</span> ip1;
  <span class="keywordtype">int</span>  ip2;
  <span class="keywordtype">char</span> op[80];
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth = <a class="code" href="group__constants.html#gga5a52">SQLO_STH_INIT</a>;

  <span class="comment">/* the stored procecdure call */</span>
  <span class="keywordtype">char</span> * stmt = 
    <span class="stringliteral">"BEGIN\n"</span>
    <span class="stringliteral">"    EX9(:ip1, :ip2, :op);\n"</span>
    <span class="stringliteral">"END;\n"</span>;


  create_sp(dbh);               <span class="comment">/* create the test stored procedure */</span>

  ip1 = 1.5;
  ip2 = 20;


  <span class="comment">/* parse the statement */</span>
  <span class="keywordflow">if</span> ( 0 &lt;= (sth = <a class="code" href="group__complex.html#ga0">sqlo_prepare</a>(dbh, stmt))) {
    <span class="comment">/* bind all variables */</span>
    <span class="keywordflow">if</span> (SQLO_SUCCESS != 
        (<a class="code" href="group__complex.html#ga1">sqlo_bind_by_name</a>(sth, <span class="stringliteral">":ip1"</span>, SQLOT_FLT, &amp;ip1, <span class="keyword">sizeof</span>(ip1), 0, 0) ||
         <a class="code" href="group__complex.html#ga1">sqlo_bind_by_name</a>(sth, <span class="stringliteral">":ip2"</span>, SQLOT_INT, &amp;ip2, <span class="keyword">sizeof</span>(ip2), 0, 0) ||
         <a class="code" href="group__complex.html#ga1">sqlo_bind_by_name</a>(sth, <span class="stringliteral">":op"</span>, SQLOT_STR, &amp;op, <span class="keyword">sizeof</span>(op), 0, 0)
         )) {

      error_exit(dbh, <span class="stringliteral">"sqlo_bind_by_name"</span>);
    } <span class="keywordflow">else</span> {
      <span class="comment">/* execute the call */</span>
      <span class="keywordflow">if</span> (SQLO_SUCCESS != <a class="code" href="group__complex.html#ga8">sqlo_execute</a>(sth, 1))
        error_exit(dbh, "sqlo_execute");
    }

    <span class="comment">/* print the result */</span>
    if (atof(op) != (ip1 + ip2))
      printf("Stored procudure returned wrong result %s, expected %6.2f\n",
             op, (ip1 + ip2));

    if (SQLO_SUCCESS != sqlo_close(sth))
      error_exit(dbh, "sqlo_execute");

  } else {
    error_exit(dbh, <span class="stringliteral">"sqlo_prepare"</span>);
  }

  <span class="keywordflow">if</span> ( 0 &gt; <a class="code" href="group__easy.html#ga16">sqlo_exec</a>(dbh, <span class="stringliteral">"DROP PROCEDURE EX9"</span>))
    error_exit(dbh, "sqlo_exec");

  return 1;
}

<span class="comment">/* creates the stored procedure used above */</span>
static <span class="keywordtype">void</span>
create_sp(sqlo_db_handle_t dbh)
{
  <span class="keywordtype">char</span> * stmt =
    <span class="stringliteral">"CREATE OR REPLACE PROCEDURE EX9(ipNum1 IN NUMBER, ipNum2 IN NUMBER, opStr OUT VARCHAR)\n"</span>
    <span class="stringliteral">"IS\n"</span>
    <span class="stringliteral">"BEGIN\n"</span>
    <span class="stringliteral">"  opStr := TO_CHAR(ipNum1 + ipNum2);\n"</span>
    <span class="stringliteral">"END;\n"</span>;

  <span class="keywordflow">if</span> (SQLO_SUCCESS != <a class="code" href="group__easy.html#ga16">sqlo_exec</a>(dbh, stmt))
    error_exit(dbh, stmt);

}

<span class="comment">/* $Id: ex9.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
</pre></div></dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__complex.html#ga0">sqlo_prepare</a>, <a class="el" href="group__complex.html#ga3">sqlo_bind_by_pos</a>, <a class="el" href="group__complex.html#ga5">sqlo_define_by_pos</a> </dd></dl>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="ex17_8c-example.html#a36">ex17.c</a>, <a class="el" href="ex18_8c-example.html#a41">ex18.c</a>, <a class="el" href="ex19_8c-example.html#a45">ex19.c</a>, and <a class="el" href="ex9_8c-example.html#a65">ex9.c</a>.</dl>    </td>
  </tr>
</table>
<a class="anchor" name="ga3" doxytag="sqlora.h::sqlo_bind_by_pos"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int sqlo_bind_by_pos           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>position</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>param_type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>param_size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>short *&nbsp;</td>
          <td class="mdname" nowrap> <em>ind_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>is_array</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bind a variable by position. 
<p>
If is_array is 1, the parameters param_addr and ind_addr must point to arrays. ind_addr is optional and can be passed a NULL. The param_size is still the size of one array element, not the whole array size!<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sth</em>&nbsp;</td><td>I - The statement handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>position</em>&nbsp;</td><td>I - The bind parameter position in the string. Starts with 1 for the first. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_type</em>&nbsp;</td><td>I - The datatype of the bind parameter (see <a class="el" href="group__constants.html#ga6">sqlo_data_types</a>). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_addr</em>&nbsp;</td><td>I - The pointer to the parameter data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_size</em>&nbsp;</td><td>I - The size of the object at param_addr in bytes. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ind_addr</em>&nbsp;</td><td>I - The pointer to the NULL indicator variable (optional). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>is_array</em>&nbsp;</td><td>I - 1 means param_addr points to an array, 0 means a single variable.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>
SQLO_SUCCESS </li>
<li>
&lt; 0 on error </li>
</ul>
</dd></dl>
<dl compact><dt><b>Example:</b></dt><dd><div class="fragment"><pre class="fragment"><span class="comment">/* $Id: ex10.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include "examples.h"</span>

<a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> prepare_cursor(sqlo_db_handle_t dbh, <span class="keywordtype">double</span> * min_salary)
{
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth;                      <span class="comment">/* statement handle */</span>

  <span class="keywordflow">if</span> (0 &gt; (sth = <a class="code" href="group__complex.html#ga0">sqlo_prepare</a>(dbh, 
                            <span class="stringliteral">"SELECT ENAME, SAL FROM EMP WHERE SAL &gt;= :salary ORDER BY 2,1"</span>)))
    error_exit(dbh, "sqlo_prepare");

  if (SQLO_SUCCESS != 
      sqlo_bind_by_pos(sth, 1, SQLOT_FLT, min_salary, sizeof(<span class="keywordtype">double</span>), 0, 0))
    error_exit(dbh, "sqlo_bind_by_pos");

  return sth;
}
<span class="comment">/* $Id: ex10.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
</pre></div> </dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__complex.html#ga0">sqlo_prepare</a>, <a class="el" href="group__complex.html#ga1">sqlo_bind_by_name</a>, <a class="el" href="group__complex.html#ga5">sqlo_define_by_pos</a> </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga4" doxytag="sqlora.h::sqlo_bind_by_pos2"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int sqlo_bind_by_pos2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>position</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>param_type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>param_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>param_size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>short *&nbsp;</td>
          <td class="mdname" nowrap> <em>ind_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short *&nbsp;</td>
          <td class="mdname" nowrap> <em>rcode_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>skip_size</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bind a variable by position. 
<p>
Bind the input variables. This new version supports arrays of structures. Set the skip_size to the size of the structure. rcode and ind must be part of the structure.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sth</em>&nbsp;</td><td>I - The statement handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>position</em>&nbsp;</td><td>I - The bind parameter position in the string. Starts with 1 for the first. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_type</em>&nbsp;</td><td>I - The datatype of the bind parameter (<a class="el" href="group__constants.html#ga6">sqlo_data_types</a>). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_addr</em>&nbsp;</td><td>I - The pointer to the parameter data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_size</em>&nbsp;</td><td>I - The size of the object at param_addr in bytes. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ind_addr</em>&nbsp;</td><td>I - The pointer to the NULL indicator variable (optional). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rcode_addr</em>&nbsp;</td><td>I - The pointer to the variable that should return the column level </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>skip_size</em>&nbsp;</td><td>I - In case into an array of structures, set to sizeof(your_struct), otherwise set it to 0.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>
SQLO_SUCCESS </li>
<li>
&lt; 0 on error </li>
</ul>
</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__complex.html#ga0">sqlo_prepare</a>, <a class="el" href="group__complex.html#ga1">sqlo_bind_by_name</a>, <a class="el" href="group__complex.html#ga5">sqlo_define_by_pos</a> </dd></dl>
<dl compact><dt><b>Since:</b></dt><dd>Version 2.2 </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="ga2" doxytag="sqlora.h::sqlo_bind_ref_cursor"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int sqlo_bind_ref_cursor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>cursor_name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>sth2p</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Bind a REF CURSOR. 
<p>
Binds a ref cursor and returns a new sth, which you can use to retrieve the data. <dl compact><dt><b>Note:</b></dt><dd>You can also use <a class="el" href="group__complex.html#ga1">sqlo_bind_by_name</a> and supply as SQLOT_RSET as type and the address of the new statement handle as param_addr. All other parameters are ignored.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sth</em>&nbsp;</td><td>I - The statement handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cursor_name</em>&nbsp;</td><td>I - The bind name of the cursor </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sth2p</em>&nbsp;</td><td>O - The new statement handle for the ref cursor.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Example:</b></dt><dd>Example using sqlo_values to get the result: <div class="fragment"><pre class="fragment"><span class="comment">/* $Id: ex17.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include "examples.h"</span>

<span class="keywordtype">int</span> select_refcursor(sqlo_db_handle_t dbh, <span class="keywordtype">double</span> min_salary)
{
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth = <a class="code" href="group__constants.html#gga5a52">SQLO_STH_INIT</a>;
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> st2h;                     <span class="comment">/* handle of the ref cursor */</span>
  <span class="keywordtype">double</span> sal = min_salary;
  CONST <span class="keywordtype">char</span> **v;
  <span class="keywordtype">int</span> status;

  CONST <span class="keywordtype">char</span> * stmt = 
    <span class="stringliteral">"BEGIN\n"</span>
    <span class="stringliteral">"    OPEN :c1 FOR SELECT ENAME, SAL FROM EMP WHERE SAL &gt;= :min_sal ORDER BY 2,1;\n"</span>
    <span class="stringliteral">"END;\n"</span>;


  <span class="comment">/* parse the statement */</span>
  <span class="keywordflow">if</span> ( 0 &lt;= (sth = <a class="code" href="group__complex.html#ga0">sqlo_prepare</a>(dbh, stmt))) {
    <span class="comment">/* bind all variables */</span>
    <span class="keywordflow">if</span> (SQLO_SUCCESS != 
        ( <a class="code" href="group__complex.html#ga2">sqlo_bind_ref_cursor</a>(sth, <span class="stringliteral">":c1"</span>, &amp;st2h)) ||
        (<a class="code" href="group__complex.html#ga1">sqlo_bind_by_name</a>(sth, <span class="stringliteral">":min_sal"</span>, SQLOT_FLT, &amp;sal, <span class="keyword">sizeof</span>(sal), 0, 0) ) ) {
      error_exit(dbh, <span class="stringliteral">"sqlo_bind_by_name"</span>);
    } <span class="keywordflow">else</span> {

      <span class="comment">/* execute the PL/SQL block */</span>
      <span class="keywordflow">if</span> (SQLO_SUCCESS != <a class="code" href="group__complex.html#ga8">sqlo_execute</a>(sth, 1))
        error_exit(dbh, "sqlo_execute");
    }
    <span class="comment">/* execute the refcursor */</span>
    if (SQLO_SUCCESS != sqlo_execute(st2h, 1)) {
      error_exit(dbh, <span class="stringliteral">"sqlo_execute(ref)"</span>);
    }

    <span class="keywordflow">while</span> (SQLO_SUCCESS == (status = <a class="code" href="group__easy.html#ga6">sqlo_fetch</a>(st2h, 1))) {
      v = <a class="code" href="group__easy.html#ga7">sqlo_values</a>(st2h, NULL, 1);

      printf(<span class="stringliteral">"Name=%-8s Salary= %-6s\n"</span>, v[0], v[1]);
    }
    
    <span class="keywordflow">if</span> (status != SQLO_NO_DATA)
      error_exit(dbh, "sqlo_fetch(st2)");

    if (SQLO_SUCCESS != sqlo_close(sth))
      error_exit(dbh, "sqlo_close(1)");

    if (SQLO_SUCCESS != sqlo_close(st2h))
      error_exit(dbh, "sqlo_close(2)");

  } else {
    error_exit(dbh, <span class="stringliteral">"sqlo_prepare"</span>);
  }

  <span class="keywordflow">return</span> 1;
}

<span class="comment">/* $Id: ex17.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
</pre></div> Example using bind variables: <div class="fragment"><pre class="fragment"><span class="comment">/* $Id: ex18.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include "examples.h"</span>

<span class="keywordtype">int</span> select_refcursor2(sqlo_db_handle_t dbh, <span class="keywordtype">double</span> min_salary)
{
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth = <a class="code" href="group__constants.html#gga5a52">SQLO_STH_INIT</a>;
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> st2h;                     <span class="comment">/* handle of the ref cursor */</span>
  <span class="keywordtype">double</span> sal = min_salary;
  <span class="keywordtype">int</span> status;
  <span class="keywordtype">char</span> name[30];
  <span class="keywordtype">double</span> salary;
  <span class="keywordtype">short</span> nind, sind;

  CONST <span class="keywordtype">char</span> * stmt = 
    <span class="stringliteral">"BEGIN\n"</span>
    <span class="stringliteral">"    OPEN :c1 FOR SELECT ENAME, SAL FROM EMP WHERE SAL &gt;= :min_sal ORDER BY 2,1;\n"</span>
    <span class="stringliteral">"END;\n"</span>;


  <span class="comment">/* parse the statement */</span>
  <span class="keywordflow">if</span> ( 0 &lt;= (sth = <a class="code" href="group__complex.html#ga0">sqlo_prepare</a>(dbh, stmt))) {

    <span class="comment">/* bind all variables */</span>
    <span class="keywordflow">if</span> (SQLO_SUCCESS != 
        (<a class="code" href="group__complex.html#ga1">sqlo_bind_by_name</a>(sth, <span class="stringliteral">":c1"</span>, SQLOT_RSET, &amp;st2h, 0, 0, 0)) ||
        (<a class="code" href="group__complex.html#ga1">sqlo_bind_by_name</a>(sth, <span class="stringliteral">":min_sal"</span>, SQLOT_FLT, &amp;sal, <span class="keyword">sizeof</span>(sal), 0, 0) ) ) {
      error_exit(dbh, <span class="stringliteral">"sqlo_bind_by_name"</span>);
    } <span class="keywordflow">else</span> {

      <span class="comment">/* execute the PL/SQL block */</span>
      <span class="keywordflow">if</span> (SQLO_SUCCESS != <a class="code" href="group__complex.html#ga8">sqlo_execute</a>(sth, 1))
        error_exit(dbh, "sqlo_execute");
    }

    <span class="comment">/* execute the second cursor */</span>
    if(SQLO_SUCCESS != sqlo_execute(st2h, 1))
      error_exit(dbh, "sqlo_execute");

    if (SQLO_SUCCESS != 
        ( sqlo_define_by_pos(st2h, 1, SQLOT_STR, name, sizeof(name), &amp;nind, 0, 0) ) ||
        ( sqlo_define_by_pos(st2h, 2, SQLOT_FLT, &amp;salary, sizeof(salary), &amp;sind, 0, 0) ) )
      {
        error_exit(dbh, <span class="stringliteral">"sqlo_define_by_pos"</span>);
      }

    <span class="keywordflow">while</span> (SQLO_SUCCESS == (status = <a class="code" href="group__easy.html#ga6">sqlo_fetch</a>(st2h, 1))) {
      printf(<span class="stringliteral">"Name=%-8s Salary= %6.2f\n"</span>, name, salary);
    }
    
    <span class="keywordflow">if</span> (status != SQLO_NO_DATA)
      error_exit(dbh, "sqlo_fetch(st2)");

    if (SQLO_SUCCESS != sqlo_close(sth))
      error_exit(dbh, "sqlo_close(1)");

    if (SQLO_SUCCESS != sqlo_close(st2h))
      error_exit(dbh, "sqlo_close(2)");

  } else {
    error_exit(dbh, <span class="stringliteral">"sqlo_prepare"</span>);
  }

  <span class="keywordflow">return</span> 1;
}

<span class="comment">/* $Id: ex18.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
</pre></div> </dd></dl>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="ex17_8c-example.html#a35">ex17.c</a>.</dl>    </td>
  </tr>
</table>
<a class="anchor" name="ga5" doxytag="sqlora.h::sqlo_define_by_pos"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int sqlo_define_by_pos           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>value_pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>value_type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>value_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>value_size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>short *&nbsp;</td>
          <td class="mdname" nowrap> <em>ind_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>short *&nbsp;</td>
          <td class="mdname" nowrap> <em>rlen_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>is_array</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Define a output variable of the select list. 
<p>
Use this to define the output variables.<p>
If is_array is 1, the parameters value_addr, rlen_addr and ind_addr must point to arrays. ind_addr is optional and can be passed a NULL. Passing NULL is only usefull for NOT NULL columns. If you ommit the indicator and a NULL is fetched, <a class="el" href="group__complex.html#ga8">sqlo_execute</a> will fail with an Oracle error (FETCHED COLUMN VALUE IS NULL).<p>
The value_size is still the size of one array element, not the whole array size!<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sth</em>&nbsp;</td><td>I - The statement handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value_pos</em>&nbsp;</td><td>I - The bind parameter position in the string. Starts with 1 for the first. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value_type</em>&nbsp;</td><td>I - The datatype of the bind parameter (<a class="el" href="group__constants.html#ga6">sqlo_data_types</a>). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value_addr</em>&nbsp;</td><td>I - The pointer to the parameter data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value_size</em>&nbsp;</td><td>I - The size of the object at param_addr in bytes. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ind_addr</em>&nbsp;</td><td>I - The pointer to the NULL indicator variable (optional). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rlen_addr</em>&nbsp;</td><td>I - The pointer where <a class="el" href="group__complex.html#ga8">sqlo_execute</a> writes the actual returned length. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>is_array</em>&nbsp;</td><td>I - 1 means param_addr points to an array, 0 means a single variable.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>
SQLO_SUCCESS </li>
<li>
&lt; 0 on error </li>
</ul>
</dd></dl>
<dl compact><dt><b>Example:</b></dt><dd><div class="fragment"><pre class="fragment"><span class="comment">/* $Id: ex11.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include "examples.h"</span>

<a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> do_select2(sqlo_db_handle_t dbh, <span class="keywordtype">double</span> min_salary)
{
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth;       <span class="comment">/* statement handle */</span>
  <span class="keywordtype">int</span> status;                   <span class="comment">/* return code of sqlo_... */</span>
  <span class="keywordtype">char</span> name[64];                <span class="comment">/* output variable for NAME */</span>
  <span class="keywordtype">short</span> name_rlen;              <span class="comment">/* returned length of NAME */</span>
  <span class="keywordtype">short</span> name_ind;               <span class="comment">/* NULL indicator for NAME */</span>
  <span class="keywordtype">short</span> sal_ind;                <span class="comment">/* NULL indicator for SALARY */</span>
  <span class="keywordtype">double</span> salary = min_salary;   <span class="comment">/* input variable for SALARY */</span>

  sth = prepare_cursor(dbh, &amp;salary); <span class="comment">/* see ex10.c */</span>

  <span class="comment">/* define output */</span>
  <span class="keywordflow">if</span> (SQLO_SUCCESS != 
      (<a class="code" href="group__complex.html#ga5">sqlo_define_by_pos</a>(sth, 1, SQLOT_STR, name, <span class="keyword">sizeof</span>(name), &amp;name_ind, &amp;name_rlen, 0)) ||
      (<a class="code" href="group__complex.html#ga5">sqlo_define_by_pos</a>(sth, 2, SQLOT_FLT, &amp;salary, <span class="keyword">sizeof</span>(salary), &amp;sal_ind, 0, 0))) {
    error_exit(dbh, <span class="stringliteral">"sqlo_define_by_pos"</span>);
  }

  status = <a class="code" href="group__complex.html#ga8">sqlo_execute</a>(sth, 0);
  <span class="keywordflow">if</span> ( 0 &gt; status)
    error_exit(dbh, "sqlo_execute");

  while ( SQLO_SUCCESS == (status = sqlo_fetch(sth, 1))) {
    printf(<span class="stringliteral">"Name=%-8s Salary=%6.2f\n"</span>, name, salary);
  }

  <span class="keywordflow">if</span> (status != SQLO_NO_DATA)
    error_exit(dbh, "sqlo_fetch");

  return sth;
}
<span class="comment">/* $Id: ex11.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
</pre></div></dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__complex.html#ga0">sqlo_prepare</a>, <a class="el" href="group__complex.html#ga1">sqlo_bind_by_name</a>, <a class="el" href="group__complex.html#ga5">sqlo_define_by_pos</a> </dd></dl>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="ex11_8c-example.html#a2">ex11.c</a>, and <a class="el" href="ex19_8c-example.html#a46">ex19.c</a>.</dl>    </td>
  </tr>
</table>
<a class="anchor" name="ga6" doxytag="sqlora.h::sqlo_define_by_pos2"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int sqlo_define_by_pos2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>value_pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>value_type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const void *&nbsp;</td>
          <td class="mdname" nowrap> <em>value_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>value_size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>short *&nbsp;</td>
          <td class="mdname" nowrap> <em>ind_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short *&nbsp;</td>
          <td class="mdname" nowrap> <em>rlen_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned short *&nbsp;</td>
          <td class="mdname" nowrap> <em>rcode_addr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>skip_size</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Define a output variable of the select list. 
<p>
Use this to define where the result of the query should go. This new version supports filling arrays of structures. If skip_size is not 0, the parameter value_addr must point to an array of structures. If used, the structure must contain variables for ind, rlen and rcode.<p>
The value_size is still the size of one array element, not the whole array size!<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sth</em>&nbsp;</td><td>I - The statement handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value_pos</em>&nbsp;</td><td>I - The bind parameter position in the string. Starts with 1 for the first. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value_type</em>&nbsp;</td><td>I - The datatype of the bind parameter (<a class="el" href="group__constants.html#ga6">sqlo_data_types</a>). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value_addr</em>&nbsp;</td><td>I - The pointer to the parameter data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value_size</em>&nbsp;</td><td>I - The size of the object at param_addr in bytes. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ind_addr</em>&nbsp;</td><td>I - The pointer to the NULL indicator variable (optional). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rlen_addr</em>&nbsp;</td><td>I - The pointer where library puts the actual return length. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rcode_addr</em>&nbsp;</td><td>I - The address where the library puts the return code for the column </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>skip_size</em>&nbsp;</td><td>I - In case into an array of structures, set to sizeof(your_struct), otherwise set it to 0.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>
SQLO_SUCCESS </li>
<li>
&lt; 0 on error </li>
</ul>
</dd></dl>
<dl compact><dt><b>Example:</b></dt><dd>This is an example of a fetch into an array of structure. <div class="fragment"><pre class="fragment"><span class="comment">/* $Id: ex12.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include "examples.h"</span>

<span class="keyword">enum</span> {
  MAX_NAME_LEN = 64,
  MAX_ARRAY_SIZE = 4            <span class="comment">/* Note: usually this should be 100 or so. </span>
<span class="comment">                                 * Used a smaller one to do test all paths in the code</span>
<span class="comment">                                 */</span>
};

<span class="keyword">typedef</span> <span class="keyword">struct </span>_result_t {
  <span class="keywordtype">char</span> name[MAX_NAME_LEN+1];    <span class="comment">/* output ENAME */</span>
  <span class="keywordtype">double</span> salary;                <span class="comment">/* output SAL */</span>
  <span class="keywordtype">short</span> name_ind;               <span class="comment">/* indicator variable of ENAME */</span>
  <span class="keywordtype">short</span> sal_ind;                <span class="comment">/* indicator variable of SAL */</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> name_rlen;     <span class="comment">/* the actual length of ENAME */</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> name_rcode;    <span class="comment">/* the return code of ENAME */</span>
} result_t;

<span class="keywordtype">void</span> print_record __P((result_t * r));


<span class="keywordtype">int</span> do_array_select(sqlo_db_handle_t dbh, <span class="keywordtype">double</span> min_salary)
{
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth;       <span class="comment">/* statement handle */</span>
  <span class="keywordtype">int</span> i;                        <span class="comment">/* loop variable */</span>
  <span class="keywordtype">int</span> status;                   <span class="comment">/* return code of sqlo_... */</span>
  result_t result[MAX_ARRAY_SIZE];
  <span class="keywordtype">int</span> rows_fetched;             <span class="comment">/* number of rows fetched per execute */</span>
  <span class="keywordtype">int</span> rows_fetched_total = 0;   <span class="comment">/* total number of rows */</span>
  <span class="keywordtype">int</span> done_fetching = 0;        <span class="comment">/* flag indicating end of fetch */</span>
  <span class="keywordtype">double</span> salary = min_salary;   <span class="comment">/* input variable for SAL */</span>
  <span class="keywordtype">int</span> skip_size = <span class="keyword">sizeof</span>(result[0]); <span class="comment">/* The skip size */</span>

  sth = prepare_cursor(dbh, &amp;salary); <span class="comment">/* see ex10.c */</span>

  <span class="comment">/* define output */</span>
  <span class="keywordflow">if</span> (SQLO_SUCCESS != 
      (<a class="code" href="group__complex.html#ga6">sqlo_define_by_pos2</a>(sth, 1, SQLOT_STR, result[0].name, <span class="keyword">sizeof</span>(result[0].name), 
                           &amp;result[0].name_ind, &amp;result[0].name_rlen, 
                           &amp;result[0].name_rcode, skip_size)) ||
      (<a class="code" href="group__complex.html#ga6">sqlo_define_by_pos2</a>(sth, 2, SQLOT_FLT, &amp;result[0].salary, <span class="keyword">sizeof</span>(result[0].salary),
                           &amp;result[0].sal_ind, 0, 0, skip_size))) {
    error_exit(dbh, <span class="stringliteral">"sqlo_define_by_pos"</span>);
  }

  <span class="comment">/* execute and fetch  the result */</span>
  status = <a class="code" href="group__complex.html#ga8">sqlo_execute</a>(sth, 0);

  <span class="keywordflow">while</span> (!done_fetching) {

    rows_fetched = MAX_ARRAY_SIZE;

    <span class="comment">/* get the next set */</span>
    status = <a class="code" href="group__easy.html#ga6">sqlo_fetch</a>(sth, MAX_ARRAY_SIZE);

    <span class="keywordflow">if</span> (0 &gt; status)
      error_exit(dbh, "sqlo_execute(NEXT)");
    else if (SQLO_NO_DATA == status) {
      
      rows_fetched = <a class="code" href="group__easy.html#ga18">sqlo_prows</a>(sth);
          
      <span class="comment">/* sqlo_prows returns now the total number of fetched rows</span>
<span class="comment">       * the difference to the previous total fechted rows is</span>
<span class="comment">       * the number of rows fetched in this last call to sqlo_execute</span>
<span class="comment">       */</span>
      rows_fetched = rows_fetched - rows_fetched_total;
      done_fetching = 1;

    }
    
    <span class="comment">/* print the records */</span>
    <span class="keywordflow">for</span> (i = 0; i &lt; rows_fetched; ++i)
      print_record(&amp;result[i]);

    rows_fetched_total += rows_fetched;

  }
  printf("Selected %d employees\n", rows_fetched_total);
  <span class="comment">/* finished. */</span>
  sqlo_close(sth);

  return 1;
}

<span class="comment">/* print record */</span>
<span class="keywordtype">void</span> print_record(result_t * r <span class="comment">/* I - The record */</span> )
{
  printf(<span class="stringliteral">"Name=%-8s Salary= %6.2f\n"</span>,
         (r-&gt;name_ind == SQLO_NULL_IND ? <span class="stringliteral">"NULL"</span> : r-&gt;name),
         (r-&gt;sal_ind == SQLO_NULL_IND ? -1.0 : r-&gt;salary));
}

<span class="comment">/* $Id: ex12.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
</pre></div></dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__complex.html#ga0">sqlo_prepare</a>, <a class="el" href="group__complex.html#ga1">sqlo_bind_by_name</a>, <a class="el" href="group__complex.html#ga5">sqlo_define_by_pos</a>, <a class="el" href="group__complex.html#ga8">sqlo_execute</a> </dd></dl>
<dl compact><dt><b>Since:</b></dt><dd>Version 2.2 </dd></dl>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="ex12_8c-example.html#a4">ex12.c</a>.</dl>    </td>
  </tr>
</table>
<a class="anchor" name="ga7" doxytag="sqlora.h::sqlo_define_ntable"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int sqlo_define_ntable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>pos</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>sth2p</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Define a nested table Please visit the example for details. 
<p>
<dl compact><dt><b>Note:</b></dt><dd>You can also use <a class="el" href="group__complex.html#ga5">sqlo_define_by_pos</a> with type == SQLOT_RSET and passing the address of the new sth as value_addr and set all other parameters to 0.</dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sth</em>&nbsp;</td><td>I - The statement handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pos</em>&nbsp;</td><td>I - The define position of the nested table </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sth2p</em>&nbsp;</td><td>O - The new statement handle for the nested table. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Examples:</b></dt><dd><div class="fragment"><pre class="fragment"><span class="comment">/* $Id: ex19.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include "examples.h"</span>

<span class="keywordtype">int</span> select_ntable(sqlo_db_handle_t dbh)
{
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> sth = <a class="code" href="group__constants.html#gga5a52">SQLO_STH_INIT</a>;
  <a class="code" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a> st2h;                     <span class="comment">/* handle of the ref cursor */</span>
  <span class="keywordtype">int</span> status;
  <span class="keywordtype">char</span> ename[11];
  <span class="keywordtype">char</span> dname[15];
  <span class="keywordtype">char</span> loc[14];
  <span class="keywordtype">short</span> eind, dind, lind;
  <span class="keywordtype">int</span> deptno = 10;

               <span class="comment">/* don't know why the bind variable for deptno causes a crash */</span>
  CONST <span class="keywordtype">char</span> * stmt = 
    <span class="stringliteral">"SELECT ENAME, CURSOR(SELECT DNAME, LOC FROM DEPT)\n"</span>
    <span class="stringliteral">"  FROM EMP WHERE DEPTNO = :deptno"</span>;


  <span class="comment">/* parse the statement */</span>
  <span class="keywordflow">if</span> ( 0 &lt;= (sth = <a class="code" href="group__complex.html#ga0">sqlo_prepare</a>(dbh, stmt))) {

    <span class="comment">/* bind all variables */</span>
    <span class="keywordflow">if</span> (SQLO_SUCCESS != 
        (<a class="code" href="group__complex.html#ga1">sqlo_bind_by_name</a>(sth, <span class="stringliteral">":deptno"</span>, SQLOT_INT, &amp;deptno, <span class="keyword">sizeof</span>(deptno), 0, 0) ) ) {
      error_exit(dbh, <span class="stringliteral">"sqlo_bind_by_name"</span>);
    } 

    <span class="comment">/* Do the defines */</span>
    <span class="comment">/* You could also do: sqlo_define_by_pos(sth, 2, SQLOT_RSET, &amp;st2h, 0, 0, 0, 0) */</span>
    <span class="keywordflow">if</span> (SQLO_SUCCESS != 
        ( <a class="code" href="group__complex.html#ga5">sqlo_define_by_pos</a>(sth, 1, SQLOT_STR, ename, <span class="keyword">sizeof</span>(ename), &amp;eind, 0, 0) ) ||
        ( <a class="code" href="group__complex.html#ga7">sqlo_define_ntable</a>(sth, 2, &amp;st2h)))
      error_exit(dbh, "sqlo_define_ntable");
    
    <span class="comment">/* execute the main statement */</span>
    if (SQLO_SUCCESS != sqlo_execute(sth, 1))
      error_exit(dbh, "sqlo_execute");
    

    <span class="comment">/* fetch from the main statement */</span>
    while (SQLO_SUCCESS == (status = sqlo_fetch(sth, 1))) {
      printf(<span class="stringliteral">"ENAME=%11s\n"</span>, ename);


      <span class="comment">/* define the output of the second cursor */</span>
      <span class="keywordflow">if</span> (SQLO_SUCCESS != 
          ( <a class="code" href="group__complex.html#ga5">sqlo_define_by_pos</a>(st2h, 1, SQLOT_STR, dname, <span class="keyword">sizeof</span>(dname), &amp;dind, 0, 0) ) ||
          ( <a class="code" href="group__complex.html#ga5">sqlo_define_by_pos</a>(st2h, 2, SQLOT_STR, loc, <span class="keyword">sizeof</span>(loc), &amp;lind, 0, 0) ) )  {
          error_exit(dbh, <span class="stringliteral">"sqlo_define_by_pos"</span>);
        }

      <span class="comment">/* execute the cursor */</span>
      <span class="keywordflow">if</span>(<a class="code" href="group__constants.html#gga3a27">SQLO_SUCCESS</a> != <a class="code" href="group__complex.html#ga8">sqlo_execute</a>(st2h, 1))
        error_exit(dbh, <span class="stringliteral">"sqlo_execute"</span>);

      <span class="comment">/* fetch from the second cursor */</span>
      <span class="keywordflow">while</span> (SQLO_SUCCESS == (status = <a class="code" href="group__easy.html#ga6">sqlo_fetch</a>(st2h, 1))) {
        printf(<span class="stringliteral">"    DNAME=%15s LOC=%15s\n"</span>, dname, loc);

      }
      <span class="keywordflow">if</span> (status != SQLO_NO_DATA)
        error_exit(dbh, "sqlo_fetch(st2)");

    }
    
    if (SQLO_SUCCESS != sqlo_close(sth))
      error_exit(dbh, "sqlo_close(1)");
    
    if (SQLO_SUCCESS != sqlo_close(st2h))
      error_exit(dbh, "sqlo_close(2)");
    
  } else {
    error_exit(dbh, <span class="stringliteral">"sqlo_prepare"</span>);
  }

  <span class="keywordflow">return</span> 1;
}

<span class="comment">/* $Id: ex19.c 221 2002-08-24 12:54:47Z kpoitschke $ */</span>
</pre></div> </dd></dl>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="ex19_8c-example.html#a47">ex19.c</a>.</dl>    </td>
  </tr>
</table>
<a class="anchor" name="ga8" doxytag="sqlora.h::sqlo_execute"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int sqlo_execute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__typedefs.html#ga1">sqlo_stmt_handle_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>sth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>unsigned int&nbsp;</td>
          <td class="mdname" nowrap> <em>iterations</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Execute a statement. 
<p>
Execute a PL/SQL block or a statement after you prepared it with sqlo_prepare and bound input and output variables. If you are fetching into arrays, you can set iterations to the actual array size. For PL/SQL blocks it must be set to 1.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sth</em>&nbsp;</td><td>I - A parsed statement handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iterations</em>&nbsp;</td><td>I - How many times the statement should be exectuted. Must be 1 if you execute a PL/SQL block</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>
SQLO_SUCCESS </li>
<li>
SQLO_NO_DATA </li>
<li>
SQLO_STILL_EXECUTING (non-blocking) </li>
<li>
&lt; 0 on error </li>
</ul>
</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__complex.html#ga0">sqlo_prepare</a>, <a class="el" href="group__complex.html#ga5">sqlo_define_by_pos</a>, <a class="el" href="group__complex.html#ga6">sqlo_define_by_pos2</a>, <a class="el" href="group__complex.html#ga1">sqlo_bind_by_name</a> </dd></dl>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="ex11_8c-example.html#a3">ex11.c</a>, <a class="el" href="ex12_8c-example.html#a5">ex12.c</a>, <a class="el" href="ex13_8c-example.html#a10">ex13.c</a>, <a class="el" href="ex14_8c-example.html#a16">ex14.c</a>, <a class="el" href="ex15_8c-example.html#a22">ex15.c</a>, <a class="el" href="ex16_8c-example.html#a29">ex16.c</a>, <a class="el" href="ex17_8c-example.html#a37">ex17.c</a>, <a class="el" href="ex18_8c-example.html#a42">ex18.c</a>, <a class="el" href="ex19_8c-example.html#a48">ex19.c</a>, and <a class="el" href="ex9_8c-example.html#a66">ex9.c</a>.</dl>    </td>
  </tr>
</table>
<a class="anchor" name="ga0" doxytag="sqlora.h::sqlo_prepare"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int sqlo_prepare           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="group__typedefs.html#ga0">sqlo_db_handle_t</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dbh</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *&nbsp;</td>
          <td class="mdname" nowrap> <em>stmt</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Parse a statement. 
<p>
This functions must be used to parse a statement if you want to bind manually the parameters. By doing this you can use native datatypes. This is the more complex form of <a class="el" href="group__easy.html#ga4">sqlo_open2</a>.<p>
If the stmt is a SELECT statement, the function sets the attribute OCI_ATTR_PREFETCH rows to the max arraysize parameter of the library. This is a kind of internal array fetch Oracle provides to speed up the fetching.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dbh</em>&nbsp;</td><td>I - A database handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>stmt</em>&nbsp;</td><td>I - sql statement.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd><ul>
<li>
A new statement handle </li>
<li>
&lt; 0 on error. </li>
</ul>
</dd></dl>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__complex.html#ga1">sqlo_bind_by_name</a>, <a class="el" href="group__complex.html#ga3">sqlo_bind_by_pos</a>, <a class="el" href="group__complex.html#ga5">sqlo_define_by_pos</a>, <a class="el" href="group__easy.html#ga4">sqlo_open2</a>. </dd></dl>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="ex10_8c-example.html#a1">ex10.c</a>, <a class="el" href="ex13_8c-example.html#a8">ex13.c</a>, <a class="el" href="ex14_8c-example.html#a14">ex14.c</a>, <a class="el" href="ex15_8c-example.html#a19">ex15.c</a>, <a class="el" href="ex16_8c-example.html#a27">ex16.c</a>, <a class="el" href="ex17_8c-example.html#a34">ex17.c</a>, <a class="el" href="ex18_8c-example.html#a40">ex18.c</a>, <a class="el" href="ex19_8c-example.html#a44">ex19.c</a>, and <a class="el" href="ex9_8c-example.html#a64">ex9.c</a>.</dl>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Fri Nov 4 16:19:04 2005 for libsqlora8 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.1 </small></address>
</body>
</html>
